<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Recipe Database Generator for The Forge - Internal tool for generating recipe data">
    <link rel="canonical" href="https://forge-calculator.com/recipes/generate-recipes.html">
    <title>Generate Recipe Database</title>
    
    <!-- START: Advertisement Code - Remove if needed -->
    <script type="text/javascript" src="https://pl28242376.effectivegatecpm.com/98/46/92/9846923cf7caa65af508e71858f9f891.js"></script>
    <!-- END: Advertisement Code -->
</head>
<body>
    <h1>Recipe Database Generator</h1>
    <button id="generateBtn">生成配方数据库</button>
    <button id="downloadBtn" style="display:none;">下载 JSON 文件</button>
    <pre id="output" style="background: #f5f5f5; padding: 20px; margin-top: 20px; max-height: 500px; overflow: auto;"></pre>

    <!-- 首先加载主计算器的所有数据 -->
    <script>
        // 这里需要包含你的主计算器代码中的所有数据定义
        // 例如：weaponProbabilities, armorProbabilities, oreData 等
        
        // 由于我们没有这些数据，这里提供一个简化的示例
        // 你需要从你的主计算器代码中复制这些数据
        
        const weaponProbabilities = {
            3: { "Dagger": 1.0 },
            6: { "Straight Sword": 0.65 },
            36: { "Colossal Sword": 0.49 }
            // ... 更多数据
        };
        
        const armorProbabilities = {
            10: { "Light Chestplate": 0.53 }
            // ... 更多数据
        };
        
        const oreData = [
            { id: 1, name: "Stone", multiplier: 0.2, rarity: "common", traits: [] },
            { id: 2, name: "Iron", multiplier: 0.35, rarity: "common", traits: [] },
            { id: 3, name: "Gold", multiplier: 0.65, rarity: "uncommon", traits: [] },
            { id: 4, name: "Rivalite", multiplier: 1.7, rarity: "rare", traits: [
                { type: "all", description: "+20% Crit Rate", scaling: { "%": { min: 10, max: 20 } } }
            ]},
            // ... 更多矿石数据
        ];
        
        const optimalCounts = {
            weapon: {
                "Dagger": 3,
                "Straight Sword": 6,
                "Colossal Sword": 36
            },
            armor: {
                "Light Chestplate": 10
            }
        };
        
        const baseItemStats = {
            weapon: {},
            armor: {}
        };
        
        const specificItemVariants = {
            weapon: {},
            armor: {}
        };
    </script>

    <!-- 然后加载配方生成器 -->
    <script src="forge-recipe-recommendations.js"></script>

    <script>
        let generatedData = null;
        
        document.getElementById('generateBtn').addEventListener('click', () => {
            try {
                // 生成配方数据库
                const db = new ForgeRecipeDatabase();
                generatedData = db.exportDatabase();
                
                // 显示结果
                document.getElementById('output').textContent = JSON.stringify(generatedData, null, 2);
                document.getElementById('downloadBtn').style.display = 'inline-block';
                
                console.log('配方数据库生成成功！', generatedData);
            } catch (error) {
                document.getElementById('output').textContent = '错误: ' + error.message + '\n\n' + error.stack;
                console.error('生成失败:', error);
            }
        });
        
        document.getElementById('downloadBtn').addEventListener('click', () => {
            if (!generatedData) return;
            
            // 创建下载链接
            const dataStr = JSON.stringify(generatedData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'recipe-database.json';
            link.click();
            
            URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>
